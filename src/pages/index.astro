---
import { getCollection } from 'astro:content';
import BaseLayout from '../components/BaseLayout.astro';
import PostCard from '../components/PostCard.astro';

// Obtener todos los posts publicados y ordenarlos por fecha
const allPosts = await getCollection('posts', ({ data }) => {
  return data.published !== false;
});

const sortedPosts = allPosts.sort((a, b) => {
  return new Date(b.data.date).getTime() - new Date(a.data.date).getTime();
});
---

<BaseLayout title="vouneo's blog - Inicio" description="Blog retro sobre black metal, ideas y meditaciones nocturnas">
  <!-- Hero section -->
  <section class="text-center mb-12 py-8">
    <h1 class="text-4xl md:text-6xl font-bold mb-4 animate-fade-in">
      <span style="color: var(--theme-accent)" class="animate-glow">
        Bienvenido
      </span>
    </h1>
    <p class="text-lg md:text-xl mb-6 max-w-2xl mx-auto leading-relaxed" style="color: var(--theme-text-secondary)">
      Un espacio digital para reflexiones sobre música, cultura y 
      <span style="color: var(--theme-accent)">meditaciones nocturnas</span>
    </p>
    
    <!-- Stats o info adicional -->
    <div class="flex flex-wrap justify-center gap-6 text-sm opacity-75">
      <div class="flex items-center gap-2">
        <span style="color: var(--theme-accent)">📝</span>
        <span>{sortedPosts.length} posts</span>
      </div>
      <div class="flex items-center gap-2">
        <span style="color: var(--theme-accent)">🎵</span>
        <span>black metal</span>
      </div>
      <div class="flex items-center gap-2">
        <span style="color: var(--theme-accent)">💭</span>
        <span>ideas</span>
      </div>
    </div>
  </section>

  <!-- Posts grid -->
  <section>
    <h2 class="text-2xl md:text-3xl font-bold mb-8 text-center">
      <span style="color: var(--theme-accent)">Últimos posts</span>
    </h2>
    
    {sortedPosts.length > 0 ? (
      <div class="posts-grid">
        {sortedPosts.map((post) => (
          <PostCard
            slug={post.slug}
            title={post.data.title}
            description={post.data.description}
            date={post.data.date}
            thumbnail={post.data.thumbnail}
            categories={post.data.categories}
          />
        ))}
      </div>
    ) : (
      <div class="text-center py-12">
        <p class="text-xl mb-4" style="color: var(--theme-muted)">
          No hay posts disponibles por el momento.
        </p>
        <p class="text-sm opacity-75">
          Pronto habrá contenido fresco aquí 🚀
        </p>
      </div>
    )}
  </section>

  <!-- Call to action retro -->
  <section class="text-center mt-16 py-8">
    <div class="retro-card max-w-lg mx-auto p-8">
      <h3 class="text-xl font-bold mb-4" style="color: var(--theme-accent)">
        ¿Te gusta el contenido?
      </h3>
      <p class="mb-6" style="color: var(--theme-text-secondary)">
        Este blog es un experimento digital nostálgico. 
        Si disfrutas de estas reflexiones, déjame saberlo.
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a 
          href="mailto:contact@vouneo.blog" 
          class="retro-button inline-block"
        >
          📧 Contacto
        </a>
        <button 
          class="retro-button"
          onclick="alert('Libro de visitas próximamente... 📖')"
        >
          📖 Libro de visitas
        </button>
      </div>
    </div>
  </section>
</BaseLayout>

<style>
  /* Animaciones específicas para la página de inicio */
  section:nth-child(1) {
    animation: fade-in-up 0.8s ease-out;
  }

  section:nth-child(2) {
    animation: fade-in-up 0.8s ease-out 0.2s both;
  }

  section:nth-child(3) {
    animation: fade-in-up 0.8s ease-out 0.4s both;
  }

  @keyframes fade-in-up {
    from {
      opacity: 0;
      transform: translateY(30px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }

  /* Efectos hover para stats */
  section:first-child div:last-child > div:hover {
    transform: scale(1.05);
    transition: transform 0.2s ease;
  }
</style>